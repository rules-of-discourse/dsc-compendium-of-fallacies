# Instructions for Building an EPUB of the Discursive Compendium of Fallacies
__NOTE:__ This build-instruction document (just like the
compendium that it instructs how to build into EPUB form)
is far from complete.
This notice will be removed when it gets to the point that
following these instructions will result in a working EPUB.

## What about formats other than EPUB?
The MOBI format (which is used for Kindle) can be generated _from_
the EPUB using a conversion tool called __kindlegen__.

## What you will need:
Aside from this project and a working unicoid environment
(such as the Gnu-Linux environment) you will need at _least_
the following tools to build the EPUB from these source files.

### chobakwrap
You will need this software as it is a prerequisite
for __chobakepubtl__. Here is how you install it.

First of all, you make sure that the __bin__ subdirectory
of your home directory is on your execution path
(which is specified by the __PATH__ environment variable).

If it's not in there, you modify your shell-profile scripts
so that it will be, then log out, and log back in again.

After that, you run the following litany in your shell:

    ( mkdir ~/bin ) 2> /dev/null
    ( mkdir ~/gitter ) 2> /dev/null
    ( mkdir ~/gitter/mnd ) 2> /dev/null
    cd ~/gitter/mnd && (
      rm -rf chobakwrap-tmp
      git clone https://github.com/sophia-collaborations/chobakwrap.git chobakwrap-tmp && (
        rm -rf chobakwrap
        mv chobakwrap-tmp chobakwrap
      )
      rm -rf chobakwrap-tmp
      cd chobakwrap && (
        sh install.sh
        sh install.sh
      )
    )

### chobakepubtl
This package is a toolchain for creating ebooks from the
command line and/or from scripts without having to use
any of the GUI-based ebook authoring applications.
You need it because it is used in the script that
generates the ebook that this project is for.

To install it, you first follow all the instructions
for installing __chobakwrap__ and then,
once you're done with that, you run the following
litany in your shell:

    ( mkdir ~/gitter ) 2> /dev/null
    ( mkdir ~/gitter/mnd ) 2> /dev/null
    cd ~/gitter/mnd && (
      rm -rf chobakepubtl-tmp
      git clone https://github.com/rules-of-discourse/chobakepubtl.git chobakepubtl-tmp && (
        rm -rf chobakepubtl
        mv chobakepubtl-tmp chobakepubtl
      )
      rm -rf chobakepubtl-tmp
      cd chobakepubtl && (
        sh install.sh
      )
    )


### xcftools
This package is used by the script to generate
the cover image of the output ebook.
How you go about installing it may
vary depending on your desktop distribution.

### imagemagick
This package is also used by the script to generate
the cover image of the output ebook.
How you go about installing it may
vary depending on your desktop distribution.

### zip
This is a well-known archiving tool.
It is needed because an EPUB document
is actually a zip archive that meets
certain additional specifications.
How you go about installing it may
vary depending on your desktop distribution.

### GIMP
Stands for __G__NU __I__mage __M__anipulation __P__rogram.
This tool is used to generate the cover image.

I'm not _certain_ that you'll need GIMP for the current
instructions how to prepare the EPUB - but I'm not
deleting it from the list of required tools until I am
_certain_ that __xcftools_ will work without GIMP installed.

### kindlegen
Well \-\- you need it if you want the MOBI file to be generated.
However, if the EPUB format is the only one you're interested in,
then you won't need this tool.

### epubcheck and it's requisite java runtime environment
The script uses __epubcheck__ to verify that the ebook
generated by the project is properly up\-to\-code.
The script goes on it's jolly way regardless of what
results __epubcheck__ gives \- however, if you have
made changes to the compendium that you plan on
contributing to the main project, any problem
that the check discovers can mean automatic rejection
of such a contribution.

For this reason, __epubcheck__ is run at the end of
the ebook preparation script, so that it's output is
as visible as possible after the script's run is complete.

Again - installation instructions can vary depending on your
environment.
In some environments, there may even be something that you
have to do after system restarts to maintain the functionality
of these tools.

However \- here, instructions are provided for such installation
on the following platforms:

  * [Crouton's Ubuntu environment](doc/epubcheck-java/crouton-ubuntu.md)

## Steps for Building the Ebook

### Prepare generated files.
Most files that you will need
come as-is in this repository.
There are a few exceptions to this.
To prepare those XHTML files that
do not come ready as-is in the repository,
use the __sh__ utility to run the
script _prepare.sh_ - which is in the
repository's main directory.

Well \-\- there used to be several
more steps.
However, with the current state
of technology, that's pretty much
all there is to do.

You will find the files _discursive-compendium.epub_
and _discursive-compendium.mobi_ appear in the
project's direcotry after you run the script.
Now, how you open the files to read \-
that depends on what ebook reader you use.





